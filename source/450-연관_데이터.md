## 평면유형 연관 데이터 처리

네이버 부동산에서 수집된 자료 중에는
평면도 외에도 평면유형과 연관된 정보가 포함된다.
이러한 정보는
한국 아파트의 진화과정을 분석하기 위하여
단위평면과 함께 딥 러닝 모형에 적용될 수 있다.
평면도와 마찬가지로,
이러한 데이터도 딥 러닝 분석에 적합한 형태로 정규화하여
한국 아파트 데이터셋에 함께 수록한다.

### 준공연도 정규화

아파트 계획의 시간에 따른 변화를 분석하기 위하여
단위평면이 계획된 시기에 대한 정보가 필요하다.
이 연구에서는
네이버 부동산에서 제공하는 준공연도를
그 기준으로 한다.
대다수의 선행연구에서,
아파트의 계획 시기는 10년 단위 연대를 전후반으로 나눈 5년 단위 구간을 기준으로 구분한다.
[@byun2016typology;@박인석2014전용면적;@이상진2019부산;@최병숙2009여성관련;@최재필1996한국;@최재필1996공간구문론을]
대규모 아파트 건설이나 계획과 관련된 법규 변화 등을 반영하여
구간의 범위를 1년 정도 옮기는 경우도 있으나,
이러한 구간 범위 조정이 모든 연구에서 일관되게 나타나지는 않는다.
이 연구에서도
이 장에서 구축하는 데이터셋을 활용한 분석 결과를
선행연구와 비교할 수 있도록,
준공연도를 5년 단위 구간으로 정규화한다.

네이버 평면도에서
평면도와 함께 수집된 준공연도는
1969년부터 2019년까지 51년의 범위에 걸쳐 있다.
단순하게 10년 단위 연대를 전후반으로 나누어 구분하면
1969년은 단독으로 1960년대 후반에 속하게 되나,
1969년에 준공된 사례는 2개 단지, 4개 평면유형에 불과하여
해당 시기에 준공된 아파트를 충분히 대표하지 못한다.
따라서 1969년 사례를 1970년대 전반에 포함하여 시기 구분을 설정한다.
최종적인 시기 구분과 해당 시기의 아파트 계획 관련 상황은 [@tbl:year]와 같다.

|코드|시기  |준공연도      |시기적 상황
|:---:|----------|----------   |------------------
|0|1970년대 전반|1969--1974|여의도 시범아파트 (1971)
|1|1970년대 후반|1975--1979|강남개발, 아파트 지구 (1975)
|2|1980년대 전반|1980--1984|2차 석유 파동 (1978--1981)
|3|1980년대 후반|1985--1989|목동 신시가지 (1983), 3저 호황 (1986--1989), 발코니 외벽 기준 면적 산입 제외 (1988)
|4|1990년대 전반|1990--1994|수도권 1기 신도시 (1988--), 발코니 창호 설치 허용 (1993)
|5|1990년대 후반|1995--1999|외환위기 (1997), 분양가 자율화 (1999)
|6|2000년대 전반|2000--2004|탑상형 아파트 도입 (2002), 발코니 창호 설치 의무화 (서울시, 2003)
|7|2000년대 후반|2005--2009|발코니 확장 허용 (2006), 분양가 상한제 (2007), 뉴타운 (2002)
|8|2010년대 전반|2010--2014|서브프라임 모기지 금융위기 (2008), 전국 주택보급률 100% 초과 (2008)
|9|2010년대 후반|2015--2019|주택시장 안정대책 (2017), 도시재생 뉴딜 (2017)

: 시기 구분 정의 {#tbl:year}

### 지역 정규화

아파트 계획의 지역별 차이를 분석하기 위하여
단위평면과 함께 해당 사례가 위치한 지역에 대한 정보가 필요하다.
평면유형의 지역은 범주형 변수에 속한다.
범주형 데이터는 그 자체로는 특별한 처리가 필요하지 않으나,
딥 러닝 모형이 범주형 변수 사이의 차이를 학습하기 위해서는
각 범주에 충분한 사례가 있어야 하며, 그 수가 균형을 이루어야 한다.
그렇지 못할 경우
사례 수가 부족한 범주에 대한 정보가 학습되지 않고
지역에 따른 차이를 정확하게 분석할 수 없게 된다.

한국의 수도권 집중은 아파트의 분포에서도 나타난다.
만약 행정구역 체계에 따라 모든 행정구역을 별개의 범주로 분류한다면
인구 규모와 아파트 사례 수가 적은 지방의 아파트에 대한 학습이 제대로 이루어질 수 없다.
따라서 단순히 같은 수준의 행정구역을 기준으로 범주화하는 것이 아니라
평면유형 사례 수를 고려하여 범주화하여야 한다.

한편, 반대로 사례 수의 균형만을 고려하여 범주화를 진행한다면
전체 사례의 약 1/3씩을 차지하는 서울과 경기는 개별 범주가 되지만,
나머지 전체 사례는 하나의 범주로 묶어야 비슷한 규모의 범주가 될 수 있다.
이 경우 수도권을 제외한 나머지 지역의 차이를 분석할 수 없게 된다.

아파트 계획 지역의 정규화는
지역별 비교에 활용하는 것을 목적으로,
각 지역의 특색을 살리면서도 각 권역의 사례 수가 균형 있게 배분되도록 범주화한다.
이를 위하여
시도 단위를 기준으로,
개별 시도에 계획된 평면유형 수와
각 시도 사이의 관계를 고려하면서
인접한 시도를 묶어 권역을 설정한다.
이러한 권역 설정을 통하여
평면유형 분포의 불균형을 완화하면서 지역별 차이를 학습할 수 있다.

충청와 전라는
평면유형 사례 수가 가장 적은 편에 속한다.
따라서 2개 도와 그 안에 위치한 자치시를 묶어 하나의 권역으로 설정한다.
이 경우 충청 권역은 약 4천 개, 전라 권역은 약 2천 개 평면유형을 포함하게 된다.
이를 기준으로 다른 시도에 대한 권역을 설정하면,
서울, 경기 권역과 함께
약 3천 개인 인천이 독립된 권역으로,
경상도는 남북으로 나누어 부산과 울산을 포함한 경남 권역과 대구를 포함한 경북 권역으로,
다른 시도와 성격이 다른 강원과 제주는 별개 권역이 된다.
이러한 정규화에 따라 전국을 총 9개 권역으로 구분한다.
한국 아파트 데이터셋에서 평면유형의 지역을 나타내는 권역코드는 [@tbl:sido]와 같다.

|권역코드|해당 지역|평면유형 수|
|:---:|-------------------------------|---------:|
|0|서울|15,125|
|1|경기|14,444|
|2|인천|3,288|
|3|강원|1,107|
|4|대전, 세종, 충남, 충북|4,226|
|5|부산, 울산, 경남|6,866|
|6|대구, 경북|3,242|
|7|광주, 전남, 전북|2,075|
|8|제주|167|

: 시도별 권역 정의 {#tbl:sido}

### 전용면적 정규화

면적은 서로 다른 두 값 사이에 비율 관게가 성립하는 비율 변수이다.
예를 들어, 120 제곱미터는 60 제곱미터보다 두 배 넓은 면적인 관계가 성립한다.
비율 변수에서는 실제로 양적 없음을 의미하는 절대영점이 존재한다.
면적이 0이라는 것은 실제로 면적이 존재하지 않음을 뜻한다.
이러한 변수를 취급할 때는
정규화 과정에서 변수에 존재하는 비율 관계가 유지될 수 있도록 유의할 필요가 있다.
비율 변수에 로그를 취하는 경우,
이러한 비율 관계를 직접 등간 변수로 표현할 수 있고,
절대영점은 무한대로 옮겨져 무시할 수 있게 된다.
따라서 로그를 취한 후 데이터에서 나타나는 값의 범위를 자유롭게 옮길 수 있다.

딥 러닝에서 사용하는 신경망 모형은
각 계층에서 출력된 값을 정규화하는 과정을 거친다.
이러한 구조 때문에
연속형 변수의 경우
입력값이 0을 중심으로 ±1 정도의 편차를 가질 때
가장 자연스럽게 학습이 가능하다.
따라서 준공연도와 전용면적 등과 같은 연속형 변수는
그 값의 범위가 -1과 1 사이에 위치하도록 변환하여
정규화할 필요가 있다.

한국 아파트의 전용면적은
국민주택 규모의 상한인 85 제곱미터보다 약간 작은 사례가 가장 많이 나타난다.
소형주택도 마찬가지로 상한인 60 제곱미터에 집중되어 나타나며,
반대로 제도적인 기준이 따로 없는 대형 평면에서는
매우 넓은 범위의 전용면적이 나타난다.
([@fig:area])
따라서 정규화된 값이 0을 중심으로 나타나도록 하려면
가장 많은 사례가 집중된 국민주택 규모 85 제곱미터가 0으로 옮겨지도록 하여야 한다.
또한, 정규화된 데이터 안에서 편차가 1로 나타나려면
그 다음으로 사례가 많은 소형주택 60 제곱미터가 0에서 1만큼 떨어진 -1 또는 1의 값을 갖도록 옮겨져야 하며,
대형 주택도 평균적으로는 1의 편차를 갖도록 하여야 한다.

![전용면적 분포](area_kde.pdf){#fig:area}

이러한 점들을 고려하여,
다음과 같이 전용면적의 정규화를 적용한다.
먼저 85 제곱미터와 60 제곱미터의 간격이 1이 되도록 로그를 취한다.
로그의 밑을 $85 \textrm{m}^2$와 $60 \textrm{m}^2$의 비율 (약 1.417)로 설정하면,
로그를 취했을 때 해당 비율이 1의 차이로 옮겨지게 된다.
다음으로, 85 제곱미터가 0으로 옮겨지도록
전용면적에 로그를 취한 값에서
85 제곱미터에 로그를 취한 값 (약 12.755)을 뺀다.
이 때 60 제곱미터는 정확히 -1로 옮겨지고,
대형 평면의 전용면적 범위 안에 속하는
약 120 제곱미터가 1의 값을 갖게 된다.

이렇게 하면 거의 모든 사례가 0 또는 0에서 1만큼 떨어진 값을 중심으로 분포하게 되어
딥 러닝에서 요구하는 입력값의 조건에 부합한다.
원래의 전용면적을 area 라고 할 때,
정규화된 전용면적 norm_area는 다음과 같이 정의된다.

$$\textrm{norm\_area} = \dfrac{\log (\textrm{area}) - \log (85)}{\log (85/60)}$$ {#eq:area}

### 침실 및 화장실 수

침실 수와 화장실 수는 절대영점이 있고 비율 관계가 성립하는 변수이다
(화장실 2개는 화장실 1개의 두 배).
그러나 현실적으로 한국 아파트의 단위평면에서
침실 수와 화장실 수는 다양하게 나타나지 않는다.
대부분의 단위평면에서 침실 수는 2--4개, 화장실 수는 1--2개의 값을 가진다.
이렇게 몇 가지 범주로 변수를 표현할 수 있는 경우,
해당 변수를 비율 변수가 아닌 명목 변수로 취급하여
양적 관계보다는 대등한 범주 사이의 비교에 활용할 수 있다.

많은 선행연구에서도 침실 수가 증가함에 따라 나타나는 선형적인 관계보다는
침실이 하나씩 증가하거나 감소함에 따른 평면 계획의 변화를 살핀다.
이러한 연구에는 침실 수와 화장실 수에 대한 전처리가 필요하지 않으며,
딥 러닝 모형에서 해당 데이터를 범주형 변수로 취급하기만 하면 된다.
따라서 침실 및 화장실의 개수는 별도 처리 없이 원래 값을 데이터셋에 포함한다.
