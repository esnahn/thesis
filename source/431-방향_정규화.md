### 평면도 방향 정규화 {#sec:orientation}

평면도 정규화의 첫 단계는
비슷한 단위평면이 같은 방향으로 비교될 수 있도록 단위평면의 방향을 정규화한다.
유사한 배치의 단위평면에서
모든 공간이 유사한 위치에 나타나도록 하여
단위평면 분석에서 공간배치의 유사성이 정확하게 인식되도록 한다.

수집된 평면도에서는
단위세대의 실제 배치와 무관하게
다양한 방향으로 표현된다.
대다수의 평면도에서
단위평면은 거실과 주 침실이 배치된 전면이 아래로 향하도록 표현된다.
남향 판상형 주동의 경우 이러한 평면도는
도면 윗쪽이 정북 방향으로 그려진 배치도와 같은 방향을 향하게 된다.
따라서 다른 방향의 판상형 아파트나 탑상형 아파트의 평면도에서도
단위세대 전면이 아래를 향하도록 그려지는 것은 자연스러운 현상일 수 있다.
그러나
모든 평면도에서
단위세대 전면이 반드시 아래쪽을 향하도록 그려진 것은 아니다.
전면이 좁고 깊은 소형 단위세대 평면 유형의 경우,
가로로 긴 평면도 이미지 안에서 단위세대가 더 크게 표현되도록
90도 회전된 형태로 표현되는 경우가 있다.
또한,
일부 평면도는 코어를 도면의 아래 부분에 배치하여,
단위세대의 여러 실이 위로 향하도록 그려지기도 한다.
이처럼 수집된 평면도는 일관된 규칙 없이 다양한 방향으로 표현되어 있기 때문에
정확한 단위평면 분석을 위하여
단위세대의 방향을 일치시켜 비교할 필요가 있다.
본 연구에서는 수집된 평면도의 대부분이 그려진 방식을 기준으로
단위평면의 주 향이 아래쪽에 오도록 정규화한다.

<!-- 
아래 = 아무거나
좌우 = 적당히
위 = 107903_113G
-->

<!-- #### 단위평면 주 향 인식 -->

서로 다른 단위평면을 동일한 방향으로 통일시키기 위해서는
단위평면의 주 향을 판단하기 위한 기준이 필요하다.
판상형 주동의 단위평면에서는 주 향이 대체로 명백하게 드러난다.
편복도형 또는 계단실형 주동에서
인접한 단위세대는 단위평면의 양 측면을 가리게 되므로,
단위평면은 전면과 후면에서만 개방될 수 있다.
전통적인 남향 주거 선호 경향에 따라
남향에 가까운 입면에
거실과 주 침실 등 주요 생활공간이 배치되어
단위평면의 전면이자 주 향의 역할이 부여된다.

그러나 모든 단위평면에서 주 향이 항상 명확한 것은 아니다.
다양한 이유로 여러 단위세대 평면도가 서로 다른 방향을 향하도록 그려지는 것과 마찬가지로,
일부 단위평면에서는 주 침실과 거실이 서로 다른 방향으로 배치되는 등
주 향을 결정하는 여러 요인이 서로 다른 방향을 나타내기 때문이다.
전면 2베이 이상 단위평면에서 대체로 거실과 주 침실이 전면에 배치되지만,
소형 평면 중에는 거실이 따로 없이 침실 2개가 전면에 배치되기도 한다.
판상형 주동에서 단위세대의 양 측면이 개방되지 않은 경우가 대부분이지만,
측면이 개방된 평면에서 전면이 아닌 측면에만 발코니가 계획되기도 한다.
탑상형 주동의 단위평면에서는 하나의 주된 향이 존재한다는 개념 자체가 도전받는다.
전면과 측면이 개방된 탑상형 평면에서는
거실과 주 침실이 남향으로 배치되어도
LDK와 나머지 침실이 4베이까지 개방되는 동향/서향이
거주자들에게 일반적으로 인지되는 개방면이 된다.
이처럼 한국 아파트의 전형적인 단위평면으로 대상을 한정하더라도
모든 단위평면에서 일관된 주 향을 정의하는 것은 어렵다.
<!--
전면 침실만
탑상형 - 그림 ??
-->

본 연구에서는
이러한 한계를 고려하여
다양한 단위평면의 공간 배치를 최대한 일관되게 비교할 수 있는
최소한의 기준을 수립한다.
한국 아파트에서 나타나는 다양한 단위평면에서 일관된 주 향을 정의하기 위해서는
주 향을 결정하는 가장 본질적인 특성을 가려낼 필요가 있다.

앞에서도 언급하였듯이,
한국 아파트에서
주 향을 정의하는 가장 중요한 특징은
남쪽을 향한 단위평면 전면에 주요 생활공간이 배치된다는 점이다.
건축법 시행령에서도
일조의 확보 대상으로 "주된 개구부"를
"거실과 주된 침실이 있는 부분의 개구부"로 정의한다.
따라서 거실과 주 침실이 남향으로 계획되는 경우
그 방향이 단위평면의 주 향이 될 수 있다.

그러나 이러한 특성은 한국 아파트 평면 대부분에서 일반적으로 성립하지만,
탑상형 주동의 단위평면에는 잘 들어맞지 않는다.
이 기준에 따르면 그림 ??의 평면이
남향으로 배치된 주 침실을 따라 전면 2베이 평면으로 해석될 수 있다.
그러나 단위평면 내부의 공간 배치를 고려하면,
거실이 더 넓게 개방되고 나머지 모든 생활공간이 배치된 쪽을 주 향으로 보아
전면 4베이 평면으로 해석하는 것이 더 적합하다.
선행연구에서도 이와 유사한 탑상형 평면을 전면 4--5베이 평면으로 해석하고 있다.
[@byun2016typology; @이상진2019부산; @윤효진2019아파트의]

본 연구에서는
한 면만 개방된 1베이 원룸부터 3면이 개방된 탑상형 평면까지
다양한 평면에 적용할 수 있는 기준으로,
주 향을
주요 생활공간의 개구부가 가장 많이 배치된 방향으로 정의한다.
이러한 정의는
전면만 개방된 중복도형 도시형생활주택의 평면이나,
전면과 후면이 개방된 편복도형 혹은 계단실형 주동의 평면,
3면이 개방된 탑상형 평면 등
다양한 조건의 단위평면에 일관된 적용이 가능하다.

그러나
[@sec:floorplan]에서 수집된 평면도에는
개구부가 정확히 표현되지 않은 경우가 많기 때문에,
단위평면에서 개구부가 배치된 방향을 직접적으로 판별하는 것은 불가능하다.
따라서 본 연구에서는
수집된 평면도에서 파악할 수 있는 정보로
주요 생활공간이 가장 많이 배치된 개방면을 추론하고 그에 따라 주 향을 결정한다.

건축법 시행령이 1986년과 1988년 두 차례에 걸쳐 개정되면서
공동주택의 발코니 면적이 바닥면적 산정에서 제외된 이후,
한국 아파트에서는
단위평면 전면 전체에 걸친 발코니 계획이 일반화된다.
따라서,
수집된 평면도에도 대부분의 경우 발코니가 표현되어 있으며,
그 배치를 통하여 개방면의 방향을 확인할 수 있다.
예를 들어,
침실이나 거실의 아래쪽에 좌우로 긴 발코니가 있다면
해당 실은 아래 방향에서 외기와 면하고 있다는 것을 알 수 있다.
만약 주요 생활공간에 계획된 여러 발코니에서 같은 배치가 나타난다면,
단위평면의 주 향이 아래쪽으로 오도록 평면도가 그려졌다고 판단할 수 있다.

발코니 배치에 기반한 개방면 추론을 적용한
단위평면의 주 향 판단은 다음과 같은 순서로 진행된다.
먼저
평면도에서 인식된 발코니 영역을 공간적 연결을 기준으로 나누어
개방면 추론의 대상으로 설정한다.
개방면 추론의 대상이 되는 발코니 영역이
반드시 하나의 실에 계획된 개별 발코니를 의미하는 것은 아니다.
예를 들어,
여러 실 앞에 일렬로 배치된 발코니가
하나로 연결되는 경우처럼,
평면도에 따라
여러 발코니가 하나의 발코니 영역으로 나타나기도 한다.
불완전한 평면도에서도 정확하게 주 향을 판단할 수 있는 알고리즘이 될 수 있도록,
이후 단계에서는
여러 발코니가 하나의 발코니 영역으로 인식되어도 결과가 달라지지 않도록 한다.

다음으로,
각 발코니 영역이 배치된 방향을
발코니 영역의 세장비와 단위평면 안에서의 배치에 기반하여 판단한다.
각 발코니 영역이 배치된 방향을 판단하는 이유는
가장 많은 발코니가 배치된 주 향을 판단하기 위한 것이다.
대다수의 평면도에서
단위평면의 주 향이 평면도의 상하좌우 4방향 중 하나를 향하고 있다고 가정하고,
따라서 주 향을 향한 발코니 또한 같은 방향으로 배치되었다고 가정한다.

각 발코니 영역이 주 향이 될 수 있는 4방향 중 어느 방향에 해당될 수 있는지를 판단한다.
발코니 영역의 수평 방향 폭과 수직 방향 높이를 비교하여 세장비를 측정하여,
폭이 높이보다 클 경우,
평면도의 상하 방향 개방면에 배치된 가로로 긴 발코니로 판단하고,
그 반대의 경우 좌우 방향으로 배치된 세로로 긴 발코니로 판단한다.
발코니가 상하 또는 좌우 중 어느 쪽으로 배치되었는지는
단위평면 안에서 발코니와 인접 공간의 배치를 통해 파악할 수 있다.
모든 발코니는 다른 공간에 부속되어 계획되므로,
발코니 양쪽 중 다른 주거 공간이 배치되지 않은 쪽이
단위평면 외부의 개방면이 된다.
발코니라는 공간의 특성상 양쪽에 실내 공간이 모두 배치될 수 없기 때문에
양쪽 중 한 쪽은 항상 다른 주거 공간이 배치될 수 없지만,
평면도의 오류 가능성을 고려하여,
양쪽 중에서 실내 공간이 더 적게 배치된 쪽을 외부로,
즉 발코니 영역의 배치 방향으로 판단한다.

마지막으로,
발코니 영역의 배치 방향을 종합하여 단위평면의 주 향을 판단한다.
발코니의 개방면에 기반한 주 향 판단은
연속된 여러 발코니가 하나의 발코니 영역으로 인식된 경우에도 그 결과가 달라지지 않아야 한다.
발코니가 몇 개의 영역으로 인식되는가와 관계없이 발코니의 면적은 달라지지 않으므로,
각 발코니 영역의 면적을 가중치로 삼아
상하좌우 4방향으로 배치된 발코니 면적 합계를 각각 집계한다.
발코니 면적의 합계가 가장 큰 방향을
발코니가 가장 많이 배치된 방향으로,
곧 발코니가 계획된 주요 생활공간이 가장 많이 계획된 단위평면의 주 향으로 판단한다.

주요 생활공간과 부속된 발코니가
한 방향에 집중적으로 배치되는 경우,
단위평면의 주 향은 해당 방향으로 쉽게 결정된다.
그러나 여러 단위세대가 일렬로 배치되는 판상형 주동에서는,
단위평면 전면과 후면의 발코니 면적이 같거나 유사한 규모로 나타날 수 있다.
이러한 경우에 발코니 면적의 미세한 차이는 주요 생활공간이 계획되었음을 나타내는 기준이 될 수 없다.
따라서 이러한 경우에는
주요 생활공간이 여러 개방면 중 어느 쪽에 면하여 배치되었는가에 따라 주 향을 판단할 필요가 있다.

본 연구에서는
주 향의 판단 기준이 되는 주요 생활공간을
일조의 확보 대상인 거실과 주 침실이 되도록 한다.
구체적으로는,
평면도의 LDK와 침실 영역 안에서 벽에서 가장 먼 지점을
주요 생활공간의 중심으로 인식하여,
발코니가 많이 배치된 여러 개방면 중에서 이 지점들과 가장 가까운 쪽을 주 향으로 판단한다.
이렇게 인식된 주 향이 아래 방향으로 통일되도록
단위평면을 정렬한다.

<!-- 주 향의 판단은
이미지의 면적, 위치, 모양 등 형태적 특성을 수치화하는
이미지 모멘트 (image moments)를 활용한다.
단면 2차 모멘트가 구조 부재의 단면 형태가 가지는 휨 저항을 보여주는 것과 마찬가지로,
이미지 모멘트를 통해 이미지의 형태가 보이는 다양한 특성을 분석할 수 있다.

대부분의 평면도에서
주 향에 거의 반드시 발코니가 배치되는 점을 이용하여,
단위평면에 발코니가 있다면,
발코니가 단위평면에서 어느 쪽 끝에 많이 배치되었는지를
이미지 모멘트를 통하여 분석한다.

이를 위하여,
이미지의 크기, 회전, 변위에 상관없이 같은 값을 유지하는
정규화된 중심 모멘트 (normalized central moments) 중 2차 모멘트를 활용하여
발코니가 실내 전체에 비하여
상하로 치우친 경향이 좌우에 비해 더 큰지를 판단한다.
만약 발코니가 평면의 위아래 끝에 위치한다면
발코니의 상하 2차 모멘트는 실내 전체에 비하여 아주 크게 나타나고,
좌우 2차 모멘트는 실내 전체와 크게 다르지 않게 나타날 것이다.
이런 경우 주 향은 아래쪽에 있다고 판단하고 회전시키지 않는다.

만약 좌우 2차 모멘트의 차이가 더 크게 나타난다면,
발코니가 왼쪽과 오른쪽 중 한쪽으로 더 치우쳐 나타난다고 판단하고,
0차 모멘트와 1차 모멘트를 이용하여
발코니의 변위가 실내 전체에 비하여 좌우 어느 쪽에 위치하는지 보고
그 쪽을 주 향으로 판단한다.
그리고 다른 평면도와 마찬가지로 주 향이 아래쪽을 향하도록 평면도를 회전시킨다.

소수의 평면 유형에는 발코니가 계획되어있지 않기 때문에
이러한 알고리즘을 사용할 수 없다.
이 경우, LDK가 단위세대 전후면에 걸쳐 좁고 길게 나타난다는 점을 이용하여,
정규화된 중심 모멘트 중 2차 모멘트가
상하와 좌우 중 어느 쪽에서 더 큰가를 기준으로 평면의 방향을 판단한다.

주 향이 아래쪽에 오도록 회전된 평면에서
현관이 왼쪽에 오도록 반전시킨다.
현관이 좌우 중 어느 쪽에 위치하는지는
현관과 실내 전체 각각에 대하여
좌우 1차 모멘트를 0차 모멘트로 나눈 값을 비교하여 알 수 있다.
현관이 실내 전체에 비하여 오른쪽에 위치한다면
좌우 반전시켜 왼쪽으로 오도록 정렬한다. -->

수집된 평면도는 주 향의 방향 뿐만 아니라
코어를 중심으로 대칭적으로 나타나는 반전된 단위평면에 대한 정규화도 필요로 한다.
네이버 부동산에서는 대칭적인 단위평면을 모두 같은 평면 유형으로 분류하며,
평면도에는 서로 반전된 두 단위평면 중 한 쪽이 일관되지 않게 표현된다.
따라서 유사한 단위평면이 반전되어 표현된 경우에도
공간배치의 유사성을 정확하게 인식할 수 있도록
단위평면과 공용 공간의 방향을 정규화한다.
이를 위하여,
단위평면과 공용 공간을 연결하는 공간인 현관을 기준으로 삼아,
주 향을 축으로 현관이 항상 한 쪽으로 향하도록 단위평면을 반전시킨다.
반전된 단위평면 중 반드시 한 쪽을 선택해야만 하는 이유는 없으므로,
수집된 평면도 다수의 배치를 따라
현관이 단위평면의 왼쪽에 위치하도록 한다.

이러한 평면도 방향 정규화 과정을 통하여,
모든 단위평면에서 일관되게
주 향이 아래쪽으로 향하고 현관이 단위평면의 왼쪽에 위치하도록
정규화한다.
