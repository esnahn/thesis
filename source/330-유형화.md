## 딥 러닝을 적용한 단위평면 유형화 {#sec:biclust}

딥 러닝 모형이 기계학습을 통하여 도출한
잠재표현 (latent representation)에서 나타나는
다양한 계획 특성을 기준으로
단위평면을 유형화하는 방법론을 수립한다.
단위평면 분류 작업을 학습한 딥 러닝 모형에 잠재된
주거공간 배치 계획 특성을 추출하고,
각 계획 특성과 이에 해당하는 단위평면을 유형화한다.
이를 통하여,
이 연구에서 수립한 표현학습 기반 주거공간 배치 분석 방법론을 검증하고,
딥 러닝 기반 건축 공간 분석의 새로운 가능성을 탐색한다.

딥 러닝 모형 내부에서
입력값의 여러 특징을 인식한 결과인 잠재표현은
출력층 직전 계층에서 수천 개의 노드가 활성화되는 값으로 표현된다.
VGGNet에서는 4096개, VGG-GAP에서는 1024개의 노드가
분류 작업을 위하여 학습한 이미지 속 다양한 패턴을 인식한다.
각 노드는 서로 독립적으로 학습한 패턴과 일치하는 영역이 나타날 때 활성화된다.
즉, 딥 러닝 모형이 데이터셋에서 학습한 잠재표현은
수천 개의 독립적인 판단으로 구성된다.

CAM 방법론은 이러한 잠재표현을 활성화하는 영역을
최종 분류의 각 범주에 따라 중첩하여 분석하는 방법론이다. [@Zhou2015]
[@fig:cam_framework]은 잠재표현의 각 노드를 활성화하는 영역을 중첩하여
해당 범주를 활성화하는 영역을 하나로 합성하는 과정을 보여준다.

![CAM 시각화의 구조 [@Zhou2015]](cam_framework.png){#fig:cam_framework}

GAP 계층의 첫 번째 노드가 활성화될 때,
사진 속 대상이 오스트레일리안 테리어 견종이라는 판단을 강화하는 정도가
w~1~로 표현되고, 두 번째 노드는 w~2~로, 마지막 노드는 w~n~으로 표현된다.
CAM은
테리어 견종이라는 판단의 근거가 되는 영역을 시각화하기 위하여,
첫 번째 노드를 활성화하는 영역에 w~1~의 가중치를 주고,
해당 영역이 테리어라는 판단을 강화하는 정도만큼만 강조되도록 한다.
사진 속에서 첫 번째 노드를 활성화하는 영역에 위치한 것은 테리어가 아니라 사람이다.
사진 속 사람의 등장은 테리어 견종을 인식하는 데 도움을 주지 않으므로,
딥 러닝 모형은 학습 과정에서 w~1~을 작게 조정하여
테리어와 관련 없는 패턴이 분류 판단에 영향을 미치지 않도록 한다.
따라서
첫 번째 노드의 활성화 영역은 최종 CAM 시각화에 크게 영향을 미치지 못한다.
반대로, 두 번째 노드는 테리어가 위치한 영역에서 나타나는 패턴을 잘 인식하고 있으므로,
w~2~는 높은 값을 갖고,
두 번째 노드를 활성화하는 영역은 최종 CAM 시각화에 큰 영향을 미친다.

이런 식으로,
각각의 노드를 활성화하는 영역이
최종 분류 판단을 강화하는 정도만큼 강조된 시각화를 도출한다.
노드별 시각화 전체를 합산하면
딥 러닝 모형 전반에 걸쳐 테리어로 분류된 근거가 되는 영역을 나타내는 시각화가 완성된다.

[-@sec:cam]절에서 수립된 주거공간 배치 분석 방법론은
이러한 CAM 방법론을 적용하여
단위평면을 주어진 기준에 따라 분류하고
그렇게 분류된 이유에 해당하는 영역을 시각화할 수 있다.
예를 들면,
시기별 혹은 지역별로 한국 아파트 단위평면에서 나타나는
계획적 특성을 시각화하여 분석할 수 있다.
[@fig:vgg_cam]은 VGG-GAP 모형에서
특정 시기나 지역 분류에 영향을 미친 영역을 강조하는
CAM 시각화를 나타내는 과정을 보여준다.

![단위평면 CAM 시각화 구조](cam.png){#fig:vgg_cam}

그러나 단위평면 계획의 변화는
사진 속 사물을 인식하는 경우에서처럼
이미지 속 한 지점에 집중되어 나타나지 않을 것이다.
그보다는,
다양한 변화가
단위평면 전반에 걸쳐 여러 영역에서 나타날 것이다.

이러한 문제는 CAM 방법론의 목표가
딥 러닝 모형의 사물 인식 결과를 검증하는 것이라는 점에
내재되어 있다.
이미지 인식 딥 러닝 모형에 대한
CAM 시각화 결과에서는,
특정 사물이 위치한 영역이 강조되기만 하면
해당 사물의 특징을 정확하게 학습하였다는 것을 검증할 수 있다.
[@fig:cam]에서
칫솔과 전기톱과 모자의 위치를 맞춘 것만 보아도
딥 러닝 모형이
이들 사물의 특징을 잘 인식한다는 것을
알 수 있는 것과 마찬가지다.

그러나 단위평면의 계획 특성은 칫솔과 전기톱처럼 명백하게 구분되지 않는다.
또한, 단위평면에서 나타나는 각 계획 특성은
사진 속 사물처럼 명백한 경계를 보이지 않는다.
따라서
단위평면의 특정 영역이 어떠한 계획 특성을 나타내는지를 설명하는 것은
사진 속 사물을 설명하는 것보다 훨씬 어려운 일이다.
그렇기 때문에,
CAM 방법론을 적용하여
분류 기준에 따라 근거 영역을 도출하여도
해당 범주의 특징을 정확하게 해석하기 어렵다.

또한,
이 연구의 방법론은
분류 작업 자체를 수행하는 모형을 검증하는 CAM 방법론보다
한 단계 더 내려가,
그 과정을 통하여 주거공간 배치의 특성을 분석하는 것이다.
마찬가지로
이 연구의 방법론을 검증하기 위해서는,
CAM이 분류의 근거가 되는 영역을 도출하는 것에서 한 단계 더 내려가
특정 범주의 계획 경향을 구성하는 계획 특성을 분리하여 분석할 필요가 있다.

주거공간 배치 계획 유형은
유사한 주거공간 배치가 나타나는 여러 단위평면과
단위평면의 해당 영역에서 활성화되는 잠재표현 노드의
연관관계에서 나타난다.
각 배치유형의 특징은
해당 유형의 단위평면에서
해당 잠재표현 노드가 활성화되는 영역을 강조하는 시각화를 통하여 표현된다.
딥 러닝 모형이 수행하도록 학습한 분류 작업에서,
분류 기준에 따른 각 범주는 여러 계획 유형과 다양한 관계를 맺는다.
또한, 한 계획 유형이 여러 범주에 걸쳐 나타날 수도 있다.

이렇게
단위평면 객체와 잠재표현 속성 양쪽에 대한 군집화를 수행할 수 있는 방법론이
바이클러스터링 (biclustering, 양방향 군집화) 분석이다.
[@scikit2020biclustering]
모든 객체의 속성 값을 행렬로 표현한 데이터 행렬에서,
서로 연관된 일부 행과 일부 열이 만드는 군집을 바이클러스터 (bicluster) 라고 한다.
바이클러스터링 분석은 전체 데이터 행렬을 바이클러스터로 분할하여,
높은 연관을 보이는 객체와 속성을 짝짓는다
([@fig:coclust]).

![바이클러스터링 분석 예시 [@scikit2020demo]](coclustering.png){#fig:coclust}

바이클러스터링 분석은
어떠한 바이클러스터를 찾는지에 따라 다양한 알고리즘이 존재하나,
일반적으로 평균 수준 대비 높거나 낮은 값의 바이클러스터를 찾게 된다.
이 연구에서는 유사한 주거공간 배치가 나타나는 일부 단위평면을 대상으로
일부 잠재표현 노드가 높은 활성화를 보이는 계획 유형을 찾고자 하므로,
평균 수준 대비 높은 값을 보이는 바이클러스터를 찾는 경우에 해당한다.

이 연구에서는
이러한 바이클러스터를 찾는 알고리즘 중 하나인
spectral co-clustering을 적용한다.
[@dhillon2001co]
이를 통해,
딥 러닝 모형이 학습한 잠재표현에 대한
바이클러스터링 분석을 통하여
단위평면 유형화를 수행한다.
Spectral co-clustering은
각 행에서 평균 대비 높은 값을 보이는 열과
각 열에서 높은 값을 보이는 행을 짝짓는다.
이러한 과정을 통하여
딥 러닝 모형이 학습한 잠재표현에서
특정한 단위평면에서 활성화되는 노드와
그 노드를 활성화하는 단위평면을 양방향으로 군집화하고,
둘을 묶어 하나의 주거공간 배치유형으로 도출하게 된다.

이 때, 모든 행과 열은 단 하나의 바이클러스터에만 속한다
([@fig:coclust]).
단위평면 유형화에 이를 적용하면,
하나의 단위평면은 하나의 배치유형에만 속하고,
각 잠재표현 노드 또한 배치유형별 모형 중 하나에만 속하게 된다.
물론 현실에서는,
하나의 단위평면 안에서
여러 주거공간에 대한
다양한 배치 계획의 변화가 동시다발적으로 일어날 수 있다.
따라서 이 연구에서 이루어지는 단위평면 유형화는
해당 계획 유형이 가장 명확하게 나타나는 단위평면을 선별한다는 의미로
한정하여 해석하여야 한다.

바이클러스터링을 통하여 도출된 단위평면 계획 유형을 해석하기 위하여,
해당 유형의 단위평면에서 해당 유형 노드를 활성화되는 영역을 시각화한다.
이는
CAM 에서 클래스 분류를 기준으로 시각화하는 대신
바이클러스터를 기준으로
잠재표현을 분리하여 시각화하는 것이다.
이 연구에서는 이러한 시각화 방법론을
BAM (bicluster activation map) 이라고 한다.

BAM은 CAM을 산출하는 수식에서 w~k~를
실제 딥 러닝 모형의 클래스 분류 가중치 대신
바이클러스터 포함 여부로 바꾼다.
또한,
CAM 분석에서 이미지의 실제 범주와 분류된 클래스는 다를 수 있기 때문에,
같은 이미지에 대하여 다양한 클래스에 대한 CAM 시각화가 도출될 수 있지만,
BAM 분석에서는
단위평면과 동일한 바이클러스터 유형에 해당하는 시각화만 도출된다.
그러나
BAM 분석 결과의 해석은 CAM과 마찬가지로,
강조된 영역이 해당 유형의 계획 특성을 보여준다는 것을 나타낸다.

단위평면의 유형화는
바이클러스터링과 BAM 시각화를
순환적으로 진행하는 과정에서 구체화된다.
바이클러스터링에서는 유형 분류가 도출되지만,
각 유형이 어떠한 계획 특성을 보여주는지를 분석하기 위해서는
BAM 시각화가 필요하다.
한편, BAM 시각화를 통해 해석된 각 유형은
다시 바이클러스터링의 군집화 결과를 활용하여 분석된다.
이러한 순환적 과정을 통하여
딥 러닝 모형이 학습한 단위평면의 주거공간 배치를
귀납적으로 도출된 주거공간 배치 계획 특성으로 유형화한다.
